{% extends "base.html" %}
{% block content %}

<div class="container py-5">
  <h2 class="mb-4">ðŸ“Š Daily Closing Report</h2>

  <!-- ðŸŸ¢ ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® -->
  <form method="get" class="mb-4 d-flex">
    <input type="date" name="date" value="{{ selected_date }}" class="form-control me-2">
    <button type="submit" class="btn btn-primary">ðŸ”Ž Ø¹Ø±Ø¶</button>
  </form>

  <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ø³ÙƒØ§Ø´Ù† -->
  <h4>Summary by Section</h4>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Section</th>
        <th>Total Quantity</th>
        <th>Total Sales</th>
      </tr>
    </thead>
    <tbody>
      {% for sec in section_summary %}
      <tr>
        <td>{{ sec.section }}</td>
        <td>{{ sec.total_qty }}</td>
        <td>{{ sec.total_sales }} EGP</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="3" class="text-center">No sales for this date</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù -->
  <h4 class="mt-5">Details by Items</h4>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Section</th>
        <th>Item</th>
        <th>Quantity</th>
        <th>Total Sales</th>
      </tr>
    </thead>
    <tbody>
      {% for item in item_summary %}
      <tr>
        <td>{{ item.menuitem__section }}</td>
        <td>{{ item.menuitem__name }}</td>
        <td>{{ item.total_qty }}</td>
        <td>{{ item.total_sales }} EGP</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="text-center">No items sold for this date</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- ðŸŸ¢ Ø§Ù„Ù†Ø³Ø±ÙŠØ§Øª ÙˆØ§Ù„ØªØ¨Ø³ -->
  <h4 class="mt-5">ðŸ’° Extra Expenses & Tips</h4>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Category</th>
        <th>Amount</th>
        <th>Created At</th>
      </tr>
    </thead>
    <tbody>
      {% for exp in expenses %}
      <tr>
        <td>{{ exp.get_category_display }}</td>
        <td>{{ exp.amount }} EGP</td>
        <td>{{ exp.created_at|date:"d M Y H:i" }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="3" class="text-center">No expenses for this date</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr class="table-secondary fw-bold">
        <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ø³Ø±ÙŠØ§Øª</td>
        <td colspan="2">{{ total_nesrayat }} EGP</td>
      </tr>
      <tr class="table-secondary fw-bold">
        <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ¨Ø³</td>
        <td colspan="2">{{ total_tips }} EGP</td>
      </tr>
      <tr class="table-dark text-white fw-bold">
        <td>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ</td>
        <td colspan="2">{{ total_all }} EGP</td>
      </tr>
    </tfoot>
  </table>
</div>

{% endblock %}
