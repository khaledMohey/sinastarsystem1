{% extends "base.html" %}
{% block content %}
<div class="container py-5">
  <h2 class="mb-4">ğŸ“’ Ù†Ø³Ø±ÙŠØ§Øª Ùˆ ØªØ¨Ø³</h2>

  <!-- ØªÙ‚Ø±ÙŠØ± Ù…Ù„Ø®Øµ -->
  <div class="alert alert-info d-flex justify-content-between">
    <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ø³Ø±ÙŠØ§Øª:</strong> {{ total_nesrayat }} Ø¬</div>
    <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ¨Ø³:</strong> {{ total_tips }} Ø¬</div>
    <div><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ:</strong> {{ total_all }} Ø¬</div>
  </div>

  <!-- ÙÙˆØ±Ù… Ø§Ù„ÙÙ„ØªØ±Ø© -->
  <form method="get" class="row g-2 mb-4">
    <div class="col-md-3">
      <input type="date" name="start_date" value="{{ start_date }}" class="form-control">
    </div>
    <div class="col-md-3">
      <input type="date" name="end_date" value="{{ end_date }}" class="form-control">
    </div>
    <div class="col-md-3">
      <select name="category" class="form-control">
        <option value="">Ø§Ù„ÙƒÙ„</option>
        <option value="nesrayat" {% if category_filter == "nesrayat" %}selected{% endif %}>Ù†Ø³Ø±ÙŠØ§Øª</option>
        <option value="tips" {% if category_filter == "tips" %}selected{% endif %}>ØªØ¨Ø³</option>
      </select>
    </div>
    <div class="col-md-3">
      <button type="submit" class="btn btn-primary w-100">ğŸ” Ø¨Ø­Ø«</button>
    </div>
  </form>

  <!-- Form Ø¥Ø¶Ø§ÙØ© -->
  <form method="post" class="mb-4">
    {% csrf_token %}
    <div class="row g-2">
      <div class="col-md-3">{{ form.category }}</div>
      <div class="col-md-3">{{ form.amount }}</div>
      <div class="col-md-4">{{ form.note }}</div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-success w-100">â• Ø¥Ø¶Ø§ÙØ©</button>
      </div>
    </div>
  </form>

  <!-- Table -->
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>#</th>
        <th>Ø§Ù„Ø¨Ù†Ø¯</th>
        <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
        <th>Ù…Ù„Ø§Ø­Ø¸Ø©</th>
        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
        <th>Ø­Ø°Ù</th>
      </tr>
    </thead>
    <tbody>
      {% for exp in expenses %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ exp.get_category_display }}</td>
        <td>{{ exp.amount }}</td>
        <td>{{ exp.note|default:"-" }}</td>
        <td>{{ exp.created_at|date:"Y-m-d H:i" }}</td>
        <td>
          <a href="{% url 'delete_expense' exp.id %}" class="btn btn-sm btn-danger"
             onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ');">ğŸ—‘ï¸</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
